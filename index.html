<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Scanner Financiero Â· DiagnÃ³stico Gratuito</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@300;400;600;700;800;900&display=swap" rel="stylesheet">
  <style>
    * { -webkit-tap-highlight-color: transparent; }
    body { font-family: 'Nunito Sans', sans-serif; }
    .pantalla { display: none; }
    .pantalla.activa { display: flex; }
    input[type=number]::-webkit-inner-spin-button,
    input[type=number]::-webkit-outer-spin-button { -webkit-appearance: none; }
    input[type=number] { -moz-appearance: textfield; }
    .fade-in { animation: fadeIn 0.35s ease forwards; }
    @keyframes fadeIn { from { opacity:0; transform:translateY(8px); } to { opacity:1; transform:translateY(0); } }
    .semaforo-verde  { border-left: 4px solid #1A7A4A; background: #E8F5EE; }
    .semaforo-amarillo { border-left: 4px solid #B8700A; background: #FFF8E6; }
    .semaforo-rojo   { border-left: 4px solid #C0392B; background: #FDECEB; }
    .dot-verde   { background:#1A7A4A; }
    .dot-amarillo { background:#B8700A; }
    .dot-rojo    { background:#C0392B; }
    .texto-verde  { color:#1A7A4A; }
    .texto-amarillo { color:#B8700A; }
    .texto-rojo   { color:#C0392B; }
    .microfrase { background: rgba(242,201,76,0.12); border:1px solid rgba(242,201,76,0.3); border-radius:10px; padding:10px 14px; font-size:13px; color:#7A5800; font-style:italic; line-height:1.5; margin-top:10px; }
    .gasto-card { background:#F8FAFC; border:1.5px solid #E2E8F0; border-radius:12px; padding:14px; }
    .gasto-card:focus-within { border-color:#1A56A0; background:#EBF3FB; }
    input:focus { outline:none; }
    .btn-pri { background:#1A56A0; color:white; font-weight:800; font-size:16px; padding:16px; border-radius:14px; width:100%; border:none; cursor:pointer; transition:all .2s; letter-spacing:.3px; }
    .btn-pri:hover { background:#1246880; transform:translateY(-1px); }
    .btn-pri:active { transform:scale(.98); }
    .btn-wa { background:#25D366; color:white; font-weight:800; font-size:16px; padding:18px; border-radius:14px; width:100%; border:none; cursor:pointer; display:flex; align-items:center; justify-content:center; gap:10px; transition:all .2s; text-decoration:none; }
    .btn-wa:active { transform:scale(.98); }
    .campo { width:100%; background:#F8FAFC; border:1.5px solid #E2E8F0; border-radius:12px; padding:14px 16px; font-family:'Nunito Sans',sans-serif; font-size:16px; color:#1E293B; }
    .campo:focus { border-color:#1A56A0; background:#EBF3FB; outline:none; }
    .campo::placeholder { color:#94A3B8; }
    .progress-bar { height:5px; background:#E2E8F0; border-radius:3px; overflow:hidden; }
    .progress-fill { height:100%; background:#1A56A0; border-radius:3px; transition:width .4s ease; }
    .score-estable  { background:linear-gradient(135deg,#E8F5EE,#D1FAE5); border:2px solid #1A7A4A; }
    .score-vulnerable { background:linear-gradient(135deg,#FFF8E6,#FEF3C7); border:2px solid #B8700A; }
    .score-critico  { background:linear-gradient(135deg,#FDECEB,#FEE2E2); border:2px solid #C0392B; }
  </style>
</head>
<body class="bg-[#EBF3FB] min-h-screen flex items-start justify-center">

<!-- â•â•â•â•â•â•â•â•â•â•â•â• CONTENEDOR MÃ“VIL â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="w-full max-w-[420px] min-h-screen bg-white flex flex-col shadow-xl relative">

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       PANTALLA 1 â€” ENTRADA SIN RESISTENCIA
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="p1" class="pantalla activa flex-col min-h-screen">

    <!-- Header azul -->
    <div class="bg-[#1A56A0] px-6 pt-12 pb-10">
      <!-- Logo Ã­cono -->
      <div class="flex justify-center mb-6">
        <div class="bg-white rounded-2xl p-3 shadow-lg">
          <svg width="52" height="52" viewBox="0 0 90 90" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="45" cy="45" r="38" stroke="#1A56A0" stroke-width="2.8" fill="none"/>
            <path d="M 45 14 A 31 31 0 1 1 14.5 55" stroke="#93C5FD" stroke-width="1.2" fill="none" stroke-linecap="round" opacity="0.5"/>
            <polyline points="12,45 22,45 27,45 31,58 36,28 41,50 45,38 49,28 53,45 63,45 78,45"
              stroke="#1A56A0" stroke-width="2.4" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
            <circle cx="49" cy="28" r="4" fill="#F2C94C"/>
            <circle cx="49" cy="28" r="2" fill="white"/>
            <circle cx="53" cy="45" r="2.5" fill="#1A56A0"/>
            <circle cx="53" cy="45" r="5" stroke="#1A56A0" stroke-width="1" fill="none" opacity="0.25"/>
          </svg>
        </div>
      </div>
      <h1 class="text-white text-2xl font-extrabold leading-tight text-center">
        Muchos negocios venden bien pero no saben con precisiÃ³n
        <span class="text-[#F2C94C]"> cuÃ¡nto ganan realmente.</span>
      </h1>
    </div>

    <!-- Cuerpo -->
    <div class="flex-1 flex flex-col px-6 py-8">
      <p class="text-[#64748B] text-[15px] leading-relaxed text-center mb-8">
        Este diagnÃ³stico te muestra la situaciÃ³n financiera real de tu empresa en <strong class="text-[#1A56A0]">3 minutos</strong>. Con tus propios nÃºmeros.
      </p>

      <!-- Trust pills -->
      <div class="flex justify-center gap-3 mb-10 flex-wrap">
        <span class="bg-[#EBF3FB] text-[#1A56A0] text-xs font-700 px-3 py-1.5 rounded-full font-bold">âœ“ Gratis</span>
        <span class="bg-[#EBF3FB] text-[#1A56A0] text-xs font-700 px-3 py-1.5 rounded-full font-bold">âœ“ 3 minutos</span>
        <span class="bg-[#EBF3FB] text-[#1A56A0] text-xs font-700 px-3 py-1.5 rounded-full font-bold">âœ“ Sin registrarte</span>
      </div>

      <div class="mt-auto">
        <button class="btn-pri" onclick="ir('p2')">Ver mi diagnÃ³stico</button>
        <p class="text-center text-xs text-[#94A3B8] mt-4 leading-relaxed">
          Tus datos no se almacenan.<br>El diagnÃ³stico es 100% local en tu dispositivo.
        </p>
      </div>
    </div>

    <!-- Copyright -->
    <div class="text-center text-xs text-[#CBD5E1] pb-6">
      Â© 2026 Scanner Financiero Â· TalÃ­a Ill Â· Tacna, PerÃº
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       PANTALLA 2 â€” LAS 6 PREGUNTAS
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="p2" class="pantalla flex-col min-h-screen">

    <!-- Header -->
    <div class="bg-white border-b border-[#E2E8F0] px-5 py-4 sticky top-0 z-10">
      <div class="flex items-center justify-between mb-3">
        <button onclick="ir('p1')" class="text-[#94A3B8] text-sm font-semibold flex items-center gap-1">
          â† AtrÃ¡s
        </button>
        <div class="flex items-center gap-2">
          <svg width="20" height="20" viewBox="0 0 90 90" fill="none">
            <circle cx="45" cy="45" r="38" stroke="#1A56A0" stroke-width="3" fill="none"/>
            <polyline points="12,45 22,45 27,45 31,58 36,28 41,50 45,38 49,28 53,45 63,45 78,45" stroke="#1A56A0" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
            <circle cx="49" cy="28" r="5" fill="#F2C94C"/>
          </svg>
          <span class="text-xs text-[#64748B] font-semibold">Paso 2 de 5</span>
        </div>
      </div>
      <div class="progress-bar"><div class="progress-fill" style="width:35%"></div></div>
    </div>

    <div class="flex-1 px-5 py-6 overflow-y-auto">
      <h2 class="text-[#0D3B6E] text-xl font-extrabold mb-1">CuÃ©ntanos sobre tu negocio</h2>
      <p class="text-[#94A3B8] text-sm mb-6">Un estimado es suficiente. No necesitas nÃºmeros exactos.</p>

      <!-- P1: Nombre empresa (opcional) -->
      <div class="mb-5">
        <label class="block text-[#1E293B] font-700 text-[15px] mb-1 font-bold">
          Â¿CÃ³mo se llama tu negocio? <span class="text-[#94A3B8] font-normal text-xs">(opcional)</span>
        </label>
        <input id="i-nombre" type="text" class="campo" placeholder="Ej: Distribuidora LÃ³pez">
      </div>

      <!-- P1: Ventas -->
      <div class="mb-5">
        <label class="block text-[#1E293B] font-bold text-[15px] mb-1">
          ğŸ’° Â¿CuÃ¡nto vendiste el mes pasado?
        </label>
        <p class="text-[#94A3B8] text-xs mb-2 italic">Un estimado estÃ¡ bien. Sin IGV si puedes.</p>
        <div class="relative">
          <span class="absolute left-4 top-1/2 -translate-y-1/2 text-[#64748B] font-bold">S/</span>
          <input id="i-ventas" type="number" min="0" class="campo pl-10" placeholder="0">
        </div>
        <p id="err-ventas" class="text-red-500 text-xs mt-1 hidden">Ingresa tus ventas para continuar.</p>
      </div>

      <!-- P2: Sueldos -->
      <div class="mb-5">
        <label class="block text-[#1E293B] font-bold text-[15px] mb-1">
          ğŸ‘¥ Â¿CuÃ¡nto pagas de sueldos en total al mes?
        </label>
        <p class="text-[#94A3B8] text-xs mb-2 italic">Lo que desembolsas. Sin incluir beneficios sociales.</p>
        <div class="relative">
          <span class="absolute left-4 top-1/2 -translate-y-1/2 text-[#64748B] font-bold">S/</span>
          <input id="i-planilla" type="number" min="0" class="campo pl-10" placeholder="0">
        </div>
      </div>

      <!-- P3: Empleados -->
      <div class="mb-5">
        <label class="block text-[#1E293B] font-bold text-[15px] mb-1">
          ğŸ·ï¸ Â¿CuÃ¡ntos empleados tiene tu empresa?
        </label>
        <p class="text-[#94A3B8] text-xs mb-2 italic">Incluye a todos, aunque sean a tiempo parcial.</p>
        <input id="i-empleados" type="number" min="0" class="campo" placeholder="0">
      </div>

      <!-- P4: Retiro dueÃ±o -->
      <div class="mb-5">
        <label class="block text-[#1E293B] font-bold text-[15px] mb-1">
          ğŸ¤² Â¿CuÃ¡nto retiras tÃº (el dueÃ±o) del negocio al mes?
        </label>
        <p class="text-[#94A3B8] text-xs mb-2 italic">Lo que te llevas mensualmente. Si no retiras nada fijo, escribe 0.</p>
        <div class="relative">
          <span class="absolute left-4 top-1/2 -translate-y-1/2 text-[#64748B] font-bold">S/</span>
          <input id="i-retiro" type="number" min="0" class="campo pl-10" placeholder="0">
        </div>
      </div>

      <!-- P5: Gastos -->
      <div class="mb-5">
        <label class="block text-[#1E293B] font-bold text-[15px] mb-2">
          ğŸ“‹ Â¿CuÃ¡nto pagas mensualmente por estos gastos?
        </label>
        <p class="text-[#94A3B8] text-xs mb-3 italic">Pon 0 si no tienes ese gasto. Un aproximado estÃ¡ bien.</p>
        <div class="grid grid-cols-2 gap-3">
          <div class="gasto-card">
            <div class="text-xl mb-1">ğŸ¢</div>
            <div class="text-xs font-bold text-[#1E293B] mb-0.5">Local / Alquiler</div>
            <div class="text-[10px] text-[#94A3B8] mb-2">Tu tienda, oficina o almacÃ©n</div>
            <div class="relative">
              <span class="absolute left-2 top-1/2 -translate-y-1/2 text-[#64748B] text-xs font-bold">S/</span>
              <input id="i-alquiler" type="number" min="0" class="w-full bg-transparent border-b border-[#CBD5E1] pl-6 text-sm text-[#1E293B] py-1 focus:border-[#1A56A0] focus:outline-none" placeholder="0">
            </div>
          </div>
          <div class="gasto-card">
            <div class="text-xl mb-1">ğŸ’¡</div>
            <div class="text-xs font-bold text-[#1E293B] mb-0.5">Servicios bÃ¡sicos</div>
            <div class="text-[10px] text-[#94A3B8] mb-2">Luz, agua, internet, telÃ©fono</div>
            <div class="relative">
              <span class="absolute left-2 top-1/2 -translate-y-1/2 text-[#64748B] text-xs font-bold">S/</span>
              <input id="i-servicios" type="number" min="0" class="w-full bg-transparent border-b border-[#CBD5E1] pl-6 text-sm text-[#1E293B] py-1 focus:border-[#1A56A0] focus:outline-none" placeholder="0">
            </div>
          </div>
          <div class="gasto-card">
            <div class="text-xl mb-1">ğŸš—</div>
            <div class="text-xs font-bold text-[#1E293B] mb-0.5">Transporte</div>
            <div class="text-[10px] text-[#94A3B8] mb-2">Gasolina, delivery, movilidad</div>
            <div class="relative">
              <span class="absolute left-2 top-1/2 -translate-y-1/2 text-[#64748B] font-bold text-xs">S/</span>
              <input id="i-transporte" type="number" min="0" class="w-full bg-transparent border-b border-[#CBD5E1] pl-6 text-sm text-[#1E293B] py-1 focus:border-[#1A56A0] focus:outline-none" placeholder="0">
            </div>
          </div>
          <div class="gasto-card">
            <div class="text-xl mb-1">ğŸ“¦</div>
            <div class="text-xs font-bold text-[#1E293B] mb-0.5">Insumos / MercaderÃ­a</div>
            <div class="text-[10px] text-[#94A3B8] mb-2">Lo que compras para vender</div>
            <div class="relative">
              <span class="absolute left-2 top-1/2 -translate-y-1/2 text-[#64748B] font-bold text-xs">S/</span>
              <input id="i-insumos" type="number" min="0" class="w-full bg-transparent border-b border-[#CBD5E1] pl-6 text-sm text-[#1E293B] py-1 focus:border-[#1A56A0] focus:outline-none" placeholder="0">
            </div>
          </div>
          <div class="gasto-card col-span-2">
            <div class="text-xl mb-1">ğŸ› ï¸</div>
            <div class="text-xs font-bold text-[#1E293B] mb-0.5">Otros pagos fijos</div>
            <div class="text-[10px] text-[#94A3B8] mb-2">Contador, seguridad, mantenimiento, suscripciones</div>
            <div class="relative">
              <span class="absolute left-2 top-1/2 -translate-y-1/2 text-[#64748B] font-bold text-xs">S/</span>
              <input id="i-otros" type="number" min="0" class="w-full bg-transparent border-b border-[#CBD5E1] pl-6 text-sm text-[#1E293B] py-1 focus:border-[#1A56A0] focus:outline-none" placeholder="0">
            </div>
          </div>
        </div>
      </div>

      <!-- P6: Deuda -->
      <div class="mb-8">
        <label class="block text-[#1E293B] font-bold text-[15px] mb-2">
          ğŸ¦ Â¿Tienes prÃ©stamos o crÃ©ditos activos?
        </label>
        <p class="text-[#94A3B8] text-xs mb-3 italic">Cuotas mensuales a bancos, financieras o prestamistas.</p>
        <div class="flex gap-3 mb-3">
          <button id="btn-deuda-no" onclick="toggleDeuda(false)"
            class="flex-1 py-3 rounded-xl border-2 border-[#1A56A0] bg-[#1A56A0] text-white font-bold text-sm transition-all">
            No tengo
          </button>
          <button id="btn-deuda-si" onclick="toggleDeuda(true)"
            class="flex-1 py-3 rounded-xl border-2 border-[#E2E8F0] text-[#64748B] font-bold text-sm transition-all">
            SÃ­ tengo
          </button>
        </div>
        <div id="campo-deuda" class="hidden">
          <div class="relative">
            <span class="absolute left-4 top-1/2 -translate-y-1/2 text-[#64748B] font-bold">S/</span>
            <input id="i-deuda" type="number" min="0" class="campo pl-10" placeholder="Cuota mensual total">
          </div>
        </div>
      </div>

      <button class="btn-pri mb-6" onclick="calcularYMostrar()">Ver mi diagnÃ³stico â†’</button>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       PANTALLA CARGA
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="p-carga" class="pantalla flex-col min-h-screen items-center justify-center bg-[#1A56A0]">
    <div class="text-center px-8">
      <div class="flex justify-center mb-8">
        <svg width="80" height="80" viewBox="0 0 90 90" fill="none" class="animate-spin" style="animation-duration:2s">
          <circle cx="45" cy="45" r="38" stroke="rgba(255,255,255,0.2)" stroke-width="3" fill="none"/>
          <path d="M 45 7 A 38 38 0 0 1 83 45" stroke="white" stroke-width="3" fill="none" stroke-linecap="round"/>
        </svg>
      </div>
      <div class="w-16 h-16 mx-auto mb-6 -mt-20 flex items-center justify-center">
        <svg width="40" height="40" viewBox="0 0 90 90" fill="none">
          <circle cx="45" cy="45" r="30" stroke="white" stroke-width="2.5" fill="none"/>
          <polyline points="18,45 28,45 32,32 37,56 42,40 47,30 51,45 60,45 72,45" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
          <circle cx="47" cy="30" r="4" fill="#F2C94C"/>
        </svg>
      </div>
      <p id="texto-carga" class="text-white text-lg font-bold mb-3 leading-tight">
        Calculando tu punto de equilibrio...
      </p>
      <p class="text-[#93C5FD] text-sm">Analizando los nÃºmeros de tu negocio</p>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       PANTALLA 3 â€” EL ESPEJO
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="p3" class="pantalla flex-col min-h-screen">

    <!-- Header -->
    <div class="bg-white border-b border-[#E2E8F0] px-5 py-4 sticky top-0 z-10">
      <div class="flex items-center justify-between mb-3">
        <button onclick="ir('p2')" class="text-[#94A3B8] text-sm font-semibold">â† AtrÃ¡s</button>
        <div class="flex items-center gap-2">
          <svg width="20" height="20" viewBox="0 0 90 90" fill="none">
            <circle cx="45" cy="45" r="38" stroke="#1A56A0" stroke-width="3" fill="none"/>
            <polyline points="12,45 22,45 27,45 31,58 36,28 41,50 45,38 49,28 53,45 63,45 78,45" stroke="#1A56A0" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
            <circle cx="49" cy="28" r="5" fill="#F2C94C"/>
          </svg>
          <span class="text-xs text-[#64748B] font-semibold">Paso 3 de 5</span>
        </div>
      </div>
      <div class="progress-bar"><div class="progress-fill" style="width:60%"></div></div>
    </div>

    <div class="flex-1 px-5 py-6 overflow-y-auto bg-[#EBF3FB]">
      <h2 class="text-[#0D3B6E] text-xl font-extrabold mb-1">Tu diagnÃ³stico financiero</h2>
      <p class="text-[#64748B] text-sm mb-6">Basado en los datos de tu negocio</p>

      <!-- REVELACIÃ“N 1 -->
      <div id="rev1" class="bg-white rounded-2xl p-5 mb-4 fade-in shadow-sm">
        <div class="flex items-center justify-between mb-3">
          <span class="text-xs font-bold text-[#64748B] uppercase tracking-wider">Tu Utilidad Real</span>
          <div class="flex items-center gap-1.5">
            <div id="dot1" class="w-2.5 h-2.5 rounded-full"></div>
            <span id="etiqueta1" class="text-xs font-bold"></span>
          </div>
        </div>
        <div id="monto1" class="text-4xl font-black mb-2"></div>
        <p id="texto1" class="text-[#64748B] text-sm leading-relaxed mb-1"></p>
        <p id="traduccion1" class="text-[#1E293B] text-[14px] font-bold leading-snug mb-2"></p>
        <div id="microfrase1" class="microfrase hidden"></div>
      </div>

      <!-- REVELACIÃ“N 2 -->
      <div id="rev2" class="bg-white rounded-2xl p-5 mb-4 fade-in shadow-sm" style="animation-delay:.1s">
        <div class="flex items-center justify-between mb-3">
          <span class="text-xs font-bold text-[#64748B] uppercase tracking-wider">El Costo Real de Tu Equipo</span>
          <div class="flex items-center gap-1.5">
            <div id="dot2" class="w-2.5 h-2.5 rounded-full"></div>
            <span id="etiqueta2" class="text-xs font-bold"></span>
          </div>
        </div>
        <div id="monto2" class="text-4xl font-black mb-2"></div>
        <p id="texto2" class="text-[#64748B] text-sm leading-relaxed mb-1"></p>
        <p id="traduccion2" class="text-[#1E293B] text-[14px] font-bold leading-snug mb-2"></p>
        <div id="microfrase2" class="microfrase hidden"></div>
      </div>

      <!-- REVELACIÃ“N 3 -->
      <div id="rev3" class="bg-white rounded-2xl p-5 mb-6 fade-in shadow-sm" style="animation-delay:.2s">
        <div class="flex items-center justify-between mb-3">
          <span class="text-xs font-bold text-[#64748B] uppercase tracking-wider">CuÃ¡nto Necesitas Vender</span>
          <div class="flex items-center gap-1.5">
            <div id="dot3" class="w-2.5 h-2.5 rounded-full"></div>
            <span id="etiqueta3" class="text-xs font-bold"></span>
          </div>
        </div>
        <div id="monto3" class="text-4xl font-black mb-2"></div>
        <p id="texto3" class="text-[#64748B] text-sm leading-relaxed mb-1"></p>
        <p id="traduccion3" class="text-[#1E293B] text-[14px] font-bold leading-snug mb-2"></p>
        <div id="microfrase3" class="microfrase hidden"></div>
      </div>

      <!-- SCORE GLOBAL -->
      <div id="score-card" class="rounded-2xl p-6 mb-6 text-center fade-in shadow-sm" style="animation-delay:.3s">
        <p class="text-xs font-bold uppercase tracking-widest text-[#64748B] mb-2">Score de Salud Financiera</p>
        <div id="score-numero" class="text-6xl font-black mb-2"></div>
        <div id="score-etiqueta" class="inline-block px-4 py-1.5 rounded-full text-sm font-black uppercase tracking-wider mb-3"></div>
        <p id="score-descripcion" class="text-sm text-[#64748B] leading-relaxed"></p>
        <div id="score-microfrase" class="microfrase hidden mt-3"></div>
      </div>

      <button class="btn-pri mb-4" onclick="ir('p4')">Ver proyecciÃ³n de tu negocio â†’</button>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       PANTALLA 4 â€” PROYECCIÃ“N
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="p4" class="pantalla flex-col min-h-screen">

    <div class="bg-white border-b border-[#E2E8F0] px-5 py-4 sticky top-0 z-10">
      <div class="flex items-center justify-between mb-3">
        <button onclick="ir('p3')" class="text-[#94A3B8] text-sm font-semibold">â† AtrÃ¡s</button>
        <div class="flex items-center gap-2">
          <svg width="20" height="20" viewBox="0 0 90 90" fill="none">
            <circle cx="45" cy="45" r="38" stroke="#1A56A0" stroke-width="3" fill="none"/>
            <polyline points="12,45 22,45 27,45 31,58 36,28 41,50 45,38 49,28 53,45 63,45 78,45" stroke="#1A56A0" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
            <circle cx="49" cy="28" r="5" fill="#F2C94C"/>
          </svg>
          <span class="text-xs text-[#64748B] font-semibold">Paso 4 de 5</span>
        </div>
      </div>
      <div class="progress-bar"><div class="progress-fill" style="width:80%"></div></div>
    </div>

    <div class="flex-1 px-5 py-6 overflow-y-auto">
      <h2 class="text-[#0D3B6E] text-xl font-extrabold mb-1">Si no se toman acciones</h2>
      <p class="text-[#64748B] text-sm mb-6">ProyecciÃ³n basada en el ritmo actual de tu negocio</p>

      <!-- Hero proyecciÃ³n -->
      <div class="bg-[#FDECEB] border border-[#C0392B] rounded-2xl p-5 text-center mb-5">
        <p class="text-[#C0392B] text-xs font-bold uppercase tracking-wider mb-2">Impacto estimado en 12 meses</p>
        <div id="proy-monto" class="text-5xl font-black text-[#C0392B] mb-1"></div>
        <p id="proy-subtitulo" class="text-[#64748B] text-sm"></p>
      </div>

      <!-- Cuerpo -->
      <div class="bg-white rounded-2xl p-5 mb-4 border border-[#E2E8F0]">
        <p id="proy-texto" class="text-[#1E293B] text-[15px] leading-relaxed mb-3"></p>
        <p class="text-[#94A3B8] text-xs italic">Este cÃ¡lculo no incluye posibles contingencias laborales ni intereses acumulados.</p>
      </div>

      <!-- Frase de esperanza -->
      <div class="bg-[#E8F5EE] border border-[#1A7A4A] rounded-2xl p-5 mb-6 text-center">
        <p class="text-[#1A7A4A] font-bold text-[15px] leading-relaxed">
          "Con la estructura financiera correcta, este escenario es completamente evitable."
        </p>
      </div>

      <button class="btn-pri mb-4" onclick="ir('p5')">Ver cÃ³mo solucionarlo â†’</button>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       PANTALLA 5 â€” CTA WHATSAPP
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="p5" class="pantalla flex-col min-h-screen">

    <div class="bg-white border-b border-[#E2E8F0] px-5 py-4 sticky top-0 z-10">
      <div class="flex items-center justify-between mb-3">
        <div></div>
        <div class="flex items-center gap-2">
          <svg width="20" height="20" viewBox="0 0 90 90" fill="none">
            <circle cx="45" cy="45" r="38" stroke="#1A56A0" stroke-width="3" fill="none"/>
            <polyline points="12,45 22,45 27,45 31,58 36,28 41,50 45,38 49,28 53,45 63,45 78,45" stroke="#1A56A0" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
            <circle cx="49" cy="28" r="5" fill="#F2C94C"/>
          </svg>
          <span class="text-xs text-[#64748B] font-semibold">Paso 5 de 5</span>
        </div>
      </div>
      <div class="progress-bar"><div class="progress-fill" style="width:100%"></div></div>
    </div>

    <div class="flex-1 px-5 py-6 overflow-y-auto">

      <!-- Recordatorio score -->
      <div id="score-reminder" class="rounded-xl p-4 text-center mb-6 border"></div>

      <h2 class="text-[#0D3B6E] text-xl font-extrabold mb-2">Ahora sabes cÃ³mo estÃ¡ tu empresa.</h2>
      <p class="text-[#64748B] text-[15px] leading-relaxed mb-6">
        El siguiente paso es entender <strong>por quÃ©</strong> y cÃ³mo ordenarlo.
      </p>

      <!-- Preview mensaje WA -->
      <div class="bg-[#E8F5EE] border border-[#A7F3D0] rounded-2xl p-4 mb-6">
        <p class="text-[#064E3B] text-xs font-bold mb-2">ğŸ’¬ Mensaje que se enviarÃ¡ a TalÃ­a:</p>
        <p id="preview-wa" class="text-[#1E293B] text-sm leading-relaxed italic"></p>
      </div>

      <!-- BotÃ³n WhatsApp -->
      <a id="btn-whatsapp" href="#" target="_blank" class="btn-wa mb-3">
        <svg width="22" height="22" viewBox="0 0 24 24" fill="white">
          <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
        </svg>
        Hablar con TalÃ­a por WhatsApp
      </a>

      <p class="text-center text-xs text-[#94A3B8] leading-relaxed mb-8">
        La primera conversaciÃ³n es sin costo.<br>Te explico quÃ© significa cada nÃºmero y si puedo ayudarte.
      </p>

      <!-- Reiniciar -->
      <button onclick="reiniciar()" class="w-full py-3 rounded-xl border border-[#E2E8F0] text-[#94A3B8] text-sm font-semibold">
        Hacer un nuevo diagnÃ³stico
      </button>
    </div>

    <div class="text-center text-xs text-[#CBD5E1] pb-6 pt-2">
      Â© 2026 Scanner Financiero Â· TalÃ­a Ill Â· Tacna, PerÃº
    </div>
  </div>

</div><!-- fin contenedor mÃ³vil -->

<!-- â•â•â•â•â•â•â•â•â•â•â•â• JAVASCRIPT â•â•â•â•â•â•â•â•â•â•â•â• -->
<script>

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CONSTANTES FINANCIERAS â€” PERÃš 2026
// Actualizar aquÃ­ si cambia la legislaciÃ³n
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const FACTOR_CARGA_LABORAL = 1.36;  // ESSALUD 9% + CTS 8.33% + Gratif. 16.67% + otros 2% = 36%
const FACTOR_CV_MINIMO     = 0.15;  // MÃ­nimo para empresas de servicios sin insumos
const SCORE_ESTABLE_MIN    = 80;
const SCORE_VULNERABLE_MIN = 50;
const TELEFONO_WA          = '5198098422'; // NÃºmero de TalÃ­a Ill

// Estado global
let resultados = {};
let tieneDeuda = false;

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// NAVEGACIÃ“N
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function ir(id) {
  document.querySelectorAll('.pantalla').forEach(p => {
    p.classList.remove('activa');
  });
  document.getElementById(id).classList.add('activa');
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// TOGGLE DEUDA
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function toggleDeuda(tiene) {
  tieneDeuda = tiene;
  const btnNo = document.getElementById('btn-deuda-no');
  const btnSi = document.getElementById('btn-deuda-si');
  const campo = document.getElementById('campo-deuda');
  if (tiene) {
    btnSi.className = 'flex-1 py-3 rounded-xl border-2 border-[#1A56A0] bg-[#1A56A0] text-white font-bold text-sm transition-all';
    btnNo.className = 'flex-1 py-3 rounded-xl border-2 border-[#E2E8F0] text-[#64748B] font-bold text-sm transition-all';
    campo.classList.remove('hidden');
  } else {
    btnNo.className = 'flex-1 py-3 rounded-xl border-2 border-[#1A56A0] bg-[#1A56A0] text-white font-bold text-sm transition-all';
    btnSi.className = 'flex-1 py-3 rounded-xl border-2 border-[#E2E8F0] text-[#64748B] font-bold text-sm transition-all';
    campo.classList.add('hidden');
    document.getElementById('i-deuda').value = '';
  }
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// FORMATEAR SOLES
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function soles(n) {
  const abs = Math.abs(n);
  return 'S/ ' + abs.toLocaleString('es-PE', { minimumFractionDigits: 0, maximumFractionDigits: 0 });
}

function val(id) {
  return parseFloat(document.getElementById(id).value) || 0;
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// MOTOR DE CÃLCULO
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function calcular(datos) {
  const { V, planilla, N, retiro, alquiler, servicios, transporte, insumos, otrosFijos, D } = datos;

  // 1. Costo laboral real
  const costoLaboralReal   = N > 0 ? planilla * FACTOR_CARGA_LABORAL : 0;
  const subregistroLaboral = costoLaboralReal - planilla;

  // 2. Estructura de costos
  const CF         = alquiler + servicios + transporte + otrosFijos + costoLaboralReal + D + retiro;
  const CV         = insumos;
  const costoTotal = CF + CV;

  // 3. Rentabilidad
  const utilidadReal = V - costoTotal;
  const margen       = V > 0 ? utilidadReal / V : 0;

  // 4. Punto de equilibrio
  const factorCV   = V > 0 ? Math.max(CV / V, FACTOR_CV_MINIMO) : FACTOR_CV_MINIMO;
  const margenDisp = 1 - factorCV;
  const PE         = margenDisp > 0 ? CF / margenDisp : null;
  const distanciaPE = PE !== null ? V - PE : null;

  // 5. Ãndices de riesgo
  const IPL        = V > 0 ? costoLaboralReal / V : 0;
  const ratioDeuda = V > 0 ? D / V : 0;

  // 6. ProyecciÃ³n anual
  const proyeccion = utilidadReal < 0
    ? Math.abs(utilidadReal) * 12
    : subregistroLaboral * 12;

  return { costoLaboralReal, subregistroLaboral, CF, CV, costoTotal,
           utilidadReal, margen, PE, distanciaPE, IPL, ratioDeuda,
           proyeccion, V, planilla, N, D };
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// MOTOR DE SCORING
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function scoring(margen, IPL, ratioDeuda) {
  let pR = 0;
  if (margen > 0.15)      pR = 40;
  else if (margen > 0.05) pR = 25;
  else if (margen >= 0)   pR = 10;
  else                    pR = 0;

  let pL = 0;
  if (IPL < 0.25)         pL = 30;
  else if (IPL <= 0.40)   pL = 20;
  else                    pL = 0;   // corregido de 5 a 0

  let pD = 0;
  if (ratioDeuda < 0.10)        pD = 30;
  else if (ratioDeuda <= 0.25)  pD = 15;
  else                          pD = 0;

  const score = pR + pL + pD;
  const clasificacion = score >= SCORE_ESTABLE_MIN    ? 'ESTABLE'
                      : score >= SCORE_VULNERABLE_MIN ? 'VULNERABLE'
                      :                                 'CRÃTICO';
  return { score, clasificacion };
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// SEMÃFORO
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function semaforo(condicion) {
  // condicion: 'verde' | 'amarillo' | 'rojo'
  const mapa = {
    verde:    { dot: 'dot-verde',    texto: 'texto-verde',    etiqueta: 'â— ESTABLE',    card: 'semaforo-verde'    },
    amarillo: { dot: 'dot-amarillo', texto: 'texto-amarillo', etiqueta: 'â—† ATENCIÃ“N',   card: 'semaforo-amarillo' },
    rojo:     { dot: 'dot-rojo',     texto: 'texto-rojo',     etiqueta: 'â–² CRÃTICO',    card: 'semaforo-rojo'     },
  };
  return mapa[condicion];
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// RENDERIZAR REVELACIONES
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderizar(r, sc) {
  const { costoLaboralReal, subregistroLaboral, utilidadReal, margen,
          PE, distanciaPE, IPL, V, planilla, N, D, proyeccion } = r;
  const { score, clasificacion } = sc;
  const nombre = document.getElementById('i-nombre').value.trim() || 'tu empresa';

  // â”€â”€ REVELACIÃ“N 1: Utilidad Real â”€â”€
  let sem1, mf1 = '';
  if (margen > 0.15)       sem1 = 'verde';
  else if (margen > 0.05)  sem1 = 'amarillo';
  else if (margen >= 0)    sem1 = 'amarillo';
  else                     sem1 = 'rojo';

  const s1 = semaforo(sem1);
  set('dot1', '', s1.dot);
  document.getElementById('dot1').className = `w-2.5 h-2.5 rounded-full ${s1.dot}`;
  document.getElementById('etiqueta1').textContent  = s1.etiqueta;
  document.getElementById('etiqueta1').className    = `text-xs font-bold ${s1.texto}`;
  document.getElementById('monto1').textContent     = utilidadReal >= 0 ? soles(utilidadReal) : '- ' + soles(utilidadReal);
  document.getElementById('monto1').className       = `text-4xl font-black mb-2 ${s1.texto}`;
  document.getElementById('texto1').textContent     = `Tus ingresos son ${soles(V)}. DespuÃ©s de todos tus costos reales, tu utilidad mensual es ${utilidadReal >= 0 ? soles(utilidadReal) : '- ' + soles(utilidadReal)}.`;
  const margenSoles = Math.round(margen * 100);
  document.getElementById('traduccion1').textContent = `De cada S/ 100 que vendes, S/ ${margenSoles >= 0 ? margenSoles : 0} son para ti.`;
  if (sem1 !== 'verde') {
    mostrarMicrofrase('microfrase1', 'Esto puede mejorar con una estructura de costos correcta.');
  }
  applyCardColor('rev1', sem1);

  // â”€â”€ REVELACIÃ“N 2: Costo Laboral â”€â”€
  if (N > 0) {
    document.getElementById('rev2').style.display = '';
    const pctSub = planilla > 0 ? subregistroLaboral / planilla : 0;
    const sem2 = pctSub > 0.20 ? 'rojo' : 'amarillo';
    const s2 = semaforo(sem2);
    document.getElementById('dot2').className     = `w-2.5 h-2.5 rounded-full ${s2.dot}`;
    document.getElementById('etiqueta2').textContent = s2.etiqueta;
    document.getElementById('etiqueta2').className   = `text-xs font-bold ${s2.texto}`;
    document.getElementById('monto2').textContent    = soles(costoLaboralReal);
    document.getElementById('monto2').className      = `text-4xl font-black mb-2 ${s2.texto}`;
    document.getElementById('texto2').textContent    = `Declaras ${soles(planilla)} en sueldos. Con ESSALUD, CTS y gratificaciones, el costo real de tu equipo es ${soles(costoLaboralReal)} al mes.`;
    document.getElementById('traduccion2').textContent = `Hay ${soles(subregistroLaboral)} que tu empresa asume cada mes sin estar registrado.`;
    mostrarMicrofrase('microfrase2', 'Registrar esto correctamente protege tu empresa ante SUNAT.');
    applyCardColor('rev2', sem2);
  } else {
    document.getElementById('rev2').style.display = 'none';
  }

  // â”€â”€ REVELACIÃ“N 3: Punto de Equilibrio â”€â”€
  if (PE !== null) {
    const sem3 = distanciaPE >= 0 ? (distanciaPE / V > 0.10 ? 'verde' : 'amarillo') : 'rojo';
    const s3 = semaforo(sem3);
    document.getElementById('dot3').className     = `w-2.5 h-2.5 rounded-full ${s3.dot}`;
    document.getElementById('etiqueta3').textContent = s3.etiqueta;
    document.getElementById('etiqueta3').className   = `text-xs font-bold ${s3.texto}`;
    document.getElementById('monto3').textContent    = soles(PE);
    document.getElementById('monto3').className      = `text-4xl font-black mb-2 ${s3.texto}`;
    document.getElementById('texto3').textContent    = `Para cubrir todos tus costos este mes, necesitas vender al menos ${soles(PE)}.`;
    if (distanciaPE !== null) {
      document.getElementById('traduccion3').textContent = distanciaPE >= 0
        ? `Tus ventas estÃ¡n ${soles(distanciaPE)} por encima de ese lÃ­mite. âœ“`
        : `Tus ventas estÃ¡n ${soles(distanciaPE)} por debajo de ese lÃ­mite.`;
    }
    if (sem3 !== 'verde') {
      mostrarMicrofrase('microfrase3', 'Conocer este nÃºmero es el primer paso para tomar decisiones con certeza.');
    }
    applyCardColor('rev3', sem3);
  } else {
    document.getElementById('monto3').textContent  = 'â€”';
    document.getElementById('texto3').textContent  = 'Tu margen no es suficiente para cubrir los costos fijos en este momento.';
    document.getElementById('traduccion3').textContent = '';
    mostrarMicrofrase('microfrase3', 'Conocer este punto es el primer paso para ordenar tu negocio.');
    applyCardColor('rev3', 'rojo');
  }

  // â”€â”€ SCORE GLOBAL â”€â”€
  const scoreCard = document.getElementById('score-card');
  scoreCard.className = scoreCard.className.replace(/score-\w+/g, '');
  let scoreClass, scoreTexto, scoreDesc, scoreMF = '';

  if (clasificacion === 'ESTABLE') {
    scoreClass = 'score-estable';
    scoreTexto = 'text-[#1A7A4A]';
    scoreDesc  = 'La estructura de tu negocio muestra seÃ±ales sÃ³lidas. Hay oportunidades de optimizaciÃ³n que pueden fortalecer aÃºn mÃ¡s tu posiciÃ³n.';
  } else if (clasificacion === 'VULNERABLE') {
    scoreClass = 'score-vulnerable';
    scoreTexto = 'text-[#B8700A]';
    scoreDesc  = 'Tu negocio tiene movimiento, pero hay puntos que merecen atenciÃ³n antes de que se conviertan en problemas mayores.';
    scoreMF    = 'Con los ajustes correctos, empresas en esta situaciÃ³n han mejorado su score en 2 a 3 meses.';
  } else {
    scoreClass = 'score-critico';
    scoreTexto = 'text-[#C0392B]';
    scoreDesc  = 'Esto es lo que muestran tus nÃºmeros hoy. No es el punto de llegada, es el punto de partida.';
    scoreMF    = 'Empresas en esta situaciÃ³n han revertido su posiciÃ³n en 3 a 6 meses con el enfoque correcto.';
  }

  scoreCard.classList.add(scoreClass, 'rounded-2xl', 'p-6', 'mb-6', 'text-center', 'fade-in', 'shadow-sm');
  document.getElementById('score-numero').textContent  = score;
  document.getElementById('score-numero').className    = `text-6xl font-black mb-2 ${scoreTexto}`;
  document.getElementById('score-etiqueta').textContent = clasificacion;
  document.getElementById('score-etiqueta').className   = `inline-block px-4 py-1.5 rounded-full text-sm font-black uppercase tracking-wider mb-3 ${scoreTexto} bg-white`;
  document.getElementById('score-descripcion').textContent = scoreDesc;
  if (scoreMF) mostrarMicrofrase('score-microfrase', scoreMF);

  // â”€â”€ PROYECCIÃ“N â”€â”€
  document.getElementById('proy-monto').textContent = soles(proyeccion);
  if (utilidadReal < 0) {
    document.getElementById('proy-subtitulo').textContent = 'podrÃ­an dejar de generarse en los prÃ³ximos 12 meses.';
    document.getElementById('proy-texto').innerHTML = `Si esta situaciÃ³n continÃºa sin ajustes, <strong>${nombre}</strong> podrÃ­a dejar de generar aproximadamente <strong>${soles(proyeccion)}</strong> en los prÃ³ximos 12 meses.`;
  } else {
    document.getElementById('proy-subtitulo').textContent = 'en costos anuales sin registrar correctamente.';
    document.getElementById('proy-texto').innerHTML = `<strong>${nombre}</strong> genera utilidad, pero hay <strong>${soles(proyeccion)}</strong> en costos anuales que no estÃ¡n siendo registrados correctamente. Esto representa un riesgo ante SUNAT.`;
  }

  // â”€â”€ SCORE REMINDER P5 â”€â”€
  const reminder = document.getElementById('score-reminder');
  reminder.className = `rounded-xl p-4 text-center mb-6 border ${
    clasificacion === 'ESTABLE'    ? 'bg-[#E8F5EE] border-[#1A7A4A]' :
    clasificacion === 'VULNERABLE' ? 'bg-[#FFF8E6] border-[#B8700A]' :
                                     'bg-[#FDECEB] border-[#C0392B]'
  }`;
  reminder.innerHTML = `
    <p class="text-xs text-[#64748B] mb-1">Tu Score de Salud Financiera</p>
    <p class="text-4xl font-black ${scoreTexto} mb-1">${score}</p>
    <p class="text-sm font-black uppercase tracking-wider ${scoreTexto}">${clasificacion}</p>
  `;

  // â”€â”€ WHATSAPP â”€â”€
  const msg = `Hola TalÃ­a, hice el diagnÃ³stico de ${nombre} y obtuve un score de ${score} (${clasificacion}). Me gustarÃ­a entender mejor mis nÃºmeros.`;
  document.getElementById('preview-wa').textContent = msg;
  document.getElementById('btn-whatsapp').href = `https://wa.me/${TELEFONO_WA}?text=${encodeURIComponent(msg)}`;
}

function applyCardColor(id, sem) {
  const el = document.getElementById(id);
  el.classList.remove('semaforo-verde','semaforo-amarillo','semaforo-rojo');
  if (sem === 'verde')    el.classList.add('semaforo-verde');
  if (sem === 'amarillo') el.classList.add('semaforo-amarillo');
  if (sem === 'rojo')     el.classList.add('semaforo-rojo');
}

function mostrarMicrofrase(id, texto) {
  const el = document.getElementById(id);
  el.textContent = 'ğŸ’¡ ' + texto;
  el.classList.remove('hidden');
}

function set(id, prop, val) {
  // helper no usado, dejado por compatibilidad
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// CALCULAR Y MOSTRAR (con pantalla de carga)
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function calcularYMostrar() {
  const V = val('i-ventas');
  if (!V || V <= 0) {
    document.getElementById('err-ventas').classList.remove('hidden');
    document.getElementById('i-ventas').focus();
    return;
  }
  document.getElementById('err-ventas').classList.add('hidden');

  const datos = {
    V,
    planilla:   val('i-planilla'),
    N:          val('i-empleados'),
    retiro:     val('i-retiro'),
    alquiler:   val('i-alquiler'),
    servicios:  val('i-servicios'),
    transporte: val('i-transporte'),
    insumos:    val('i-insumos'),
    otrosFijos: val('i-otros'),
    D:          tieneDeuda ? val('i-deuda') : 0,
  };

  // Pantalla de carga
  ir('p-carga');

  const frases = [
    'Calculando tu punto de equilibrio...',
    'Revisando el costo real de tu equipo...',
    'Preparando tu diagnÃ³stico financiero...'
  ];
  let i = 0;
  const intervalo = setInterval(() => {
    document.getElementById('texto-carga').textContent = frases[i % 3];
    i++;
  }, 500);

  setTimeout(() => {
    clearInterval(intervalo);
    resultados = calcular(datos);
    const sc    = scoring(resultados.margen, resultados.IPL, resultados.ratioDeuda);
    renderizar(resultados, sc);
    ir('p3');
  }, 1800);
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// REINICIAR
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function reiniciar() {
  ['i-nombre','i-ventas','i-planilla','i-empleados','i-retiro',
   'i-alquiler','i-servicios','i-transporte','i-insumos','i-otros','i-deuda']
    .forEach(id => document.getElementById(id).value = '');
  toggleDeuda(false);
  ir('p1');
}

</script>
</body>
</html>
